
@{
    ViewData["Title"] = "جست و جو";
    Layout = "~/Views/Shared/_LayoutPaycell.cshtml";
}

<h1>جست و جو</h1>

<form method="post">
    <div class="row">
        <div class="col-md-6">
            <label class="col-md-6" for="TransactionProductTypeId">گروه محصول</label>
            <div class="col-md-6">
                <select class="form-control" asp-items="ViewBag.TransactionTypeId" name="TransactionTypeId" id="TransactionTypeId">
                    <option value="">همه</option>
                </select>
            </div>
        </div>
        <div class="col-md-6">
            <label class="col-md-6" for="TransactionProductTypeId">زیر گروه محصول</label>
            <div class="col-md-6">
                <select class="form-control" asp-items="ViewBag.TransactionProductTypeId" name="TransactionProductTypeId" id="TransactionProductTypeId">
                    <option value="">همه</option>
                </select>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <label class="col-md-6" for="searchPriceFrom">از قیمت</label>
            <div class="col-md-6">
                <input type="number" name="searchPriceFrom" id="searchPriceFrom" value="@ViewBag.searchPriceFrom" class="form-control" />
            </div>
        </div>
        <div class="col-md-6">
            <label class="col-md-6" for="searchPriceTo">تا قیمت</label>
            <div class="col-md-6">
                <input type="number" name="searchPriceTo" id="searchPriceTo" value="@ViewBag.searchPriceTo" class="form-control" />
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <label class="col-md-6" for="CompanyId">شرکت</label>
            <div class="col-md-6">
                <select class="form-control" asp-items="ViewBag.CompanyId" name="CompanyId" id="CompanyId">
                    <option value="">همه</option>
                </select>
            </div>
        </div>
        <div class="col-md-6">
            <button type="submit">جست و جو <i class="glyphicon glyphicon-search"></i></button>
        </div>
    </div>
</form>

<script type="text/javascript">
    var TransactionProductType = JSON.parse('@Html.Raw(ViewBag.TransactionProductType)');
    var TransactionType = JSON.parse('@Html.Raw(ViewBag.TransactionType)');
    var Company = JSON.parse('@Html.Raw(ViewBag.Company)');
    function Product(productId) {
        for (var i = 0; i < TransactionProductType.length; i++) {
            if (TransactionProductType[i].TransactionProductTypeId == productId) {
                return TransactionProductType[i];
            }
        }
        return "";
    }
    function TransactionTypes(typeId) {
        for (var i = 0; i < TransactionType.length; i++) {
            if (TransactionType[i].TransactionTypeId == typeId) {
                return TransactionType[i];
            }
        }
        return "";
    }
    function CompanyName(productId) {
        var ci = Product(productId).CompanyId;
        debugger;
        for (var i = 0; i < Company.length; i++) {
            if (Company[i].CompanyId == ci)
                return Company[i].Name;
        }
        return "";

    }
    function loadURL(TransactionProductTypeId) {
        window.location.href = Product(parseInt(TransactionProductTypeId)).SalePageURL;
    }
</script>
@if (ViewBag.Results != null)
{
    for (int i = 0; i < ViewBag.Results.Rows.Count; i += 2)
    {
        var item = ViewBag.Results.Rows[i];
        <div class="row">
            <div class="col-md-6">
                <div class="invoice-ribbon-right"><div class="ribbon-inner-right">@(" مبلغ " + ((long)item["Amount"]).ToString("N0") + " ريال ")</div></div>

                <a href="javascript:loadURL('@(item["TransactionProductTypeId"].ToString())')">
                    <div class="panel panel-default ">
                        <div class="panel-body">
                            <label class="col-lg-4">
                                شرکت
                                <script>document.write(CompanyName(parseInt('@(item["TransactionProductTypeId"].ToString())')))</script>
                            </label>
                            <div class="col-lg-4">
                                <script>document.write(Product(parseInt('@(item["TransactionProductTypeId"].ToString())')).Title)</script>
                            </div>
                            <div class="col-lg-4">
                                <script>document.write(TransactionTypes(parseInt('@(item["TransactionTypeId"].ToString())')).Title)</script>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
            @if (i + 1 < ViewBag.Results.Rows.Count)
            {
                item = ViewBag.Results.Rows[i + 1];
                <div class="col-md-6">
                    <div class="invoice-ribbon-right"><div class="ribbon-inner-right">@(" مبلغ " + ((long)item["Amount"]).ToString("N0") + " ريال ")</div></div>

                    <a href="javascript:loadURL('@(item["TransactionProductTypeId"].ToString())')">
                        <div class="panel panel-default ">
                            <div class="panel-body">
                                <label class="col-lg-4">
                                    شرکت
                                    <script>document.write(CompanyName(parseInt('@(item["TransactionProductTypeId"].ToString())')))</script>
                                </label>
                                <div class="col-lg-4">
                                    <script>document.write(Product(parseInt('@(item["TransactionProductTypeId"].ToString())')).Title)</script>
                                </div>
                                <div class="col-lg-4">
                                    <script>document.write(TransactionTypes(parseInt('@(item["TransactionTypeId"].ToString())')).Title)</script>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
            }
        </div>
    }
}

<style>


    .invoice-ribbon {
        width: 85px;
        height: 88px;
        overflow: hidden;
        position: absolute;
        top: -1px;
        left: 14px;
    }

    .ribbon-inner {
        text-align: center;
        -webkit-transform: rotate(45deg);
        -moz-transform: rotate(45deg);
        -ms-transform: rotate(45deg);
        -o-transform: rotate(45deg);
        position: relative;
        padding: 7px 0;
        right: -5px;
        top: 11px;
        width: 120px;
        background-color: #66c591;
        font-size: 15px;
        color: #fff;
    }

        .ribbon-inner:before, .ribbon-inner:after {
            content: "";
            position: absolute;
        }

        .ribbon-inner:before {
            right: 0;
        }

        .ribbon-inner:after {
            left: 0;
        }



    .invoice-ribbon-right {
        direction: ltr;
        width: 85px;
        height: 88px;
        overflow: hidden;
        position: absolute;
        top: -1px;
        right: 14px;
    }

    .ribbon-inner-right {
        text-align: center;
        -webkit-transform: rotate(45deg);
        -moz-transform: rotate(45deg);
        -ms-transform: rotate(45deg);
        -o-transform: rotate(45deg);
        position: relative;
        padding: 7px 0;
        left: -5px;
        top: 11px;
        width: 120px;
        background-color: #66c591;
        font-size: x-small;
        color: #fff;
    }

        .ribbon-inner-right:before, .ribbon-inner-right:after {
            content: "";
            position: absolute;
        }

        .ribbon-inner-right:before {
            left: 0;
        }

        .ribbon-inner-right:after {
            right: 0;
        }
</style>

@section Scripts{
}